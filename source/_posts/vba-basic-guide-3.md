layout: posts
title: VBA简明教程之三 - VBA编辑器
date: 2017-01-04 21:16:54
tags: VBA
categories: Office Skill
---

## 打开方式

可以通过以下几种方式打开VBA编辑器：
 - 快捷键ALT+F11。
 - 在**DEVELOPER**菜单下点击Visual Basic图标。
 - 在**DEVELOPER**菜单下点击Macros图标，然后在列表中选择一个Macro，点击右侧的Edit。

<!--more-->

## 窗口概览

先看截图：

![VBA Editor](/images/vba-editor.png)

### 顶部常用工具栏

常用工具栏为截图中编号为1的区域，在其上方是Windows中常见的菜单栏。

如果发现只有菜单栏，而没有常用工具栏的话，可以通过以下步骤打开：

 1. 点击菜单栏中的**View**。
 2. 点击Toolbar二级菜单中的**Standard**。

![Standard Toolbar](/images/standard-toolbar.png)

关于这一部分每个按钮的作用会在后续的内容中涉及到，这里不做详细解释。

### 工程窗口

工程窗口为截图中编号为2的区域，如果找不到此窗口，可以通过快捷键Ctrl+R打开。

此窗口又被称为“Project Explorer”，这里列出的是当前工作簿中的一些对象：

 - VBAProject(2016 Revenues.xlsx): 括号中的内容是当前打开的工作簿的名字，如果同时打开了多个工作簿，会有另外一个VBAProject存在，如下图所示，表示当前同时打开了两个工作簿，分别是2016 Revenues.xlsx和2015 Revenues.xlsx：

![Two Workbooks](/images/two-workbooks-in-vba-e.png)

 - Microsoft Excel Objects: 这个文件夹下会列出当前工作簿中所有的工作表，括号中是工作表的的名字，括号外是工作表的编号。除此之外，还有一个叫做**ThisWorkbook**的对象，表示的是当前工作表。

 - Modules: 这个文件夹下会列出当前工作簿中，所有的VBA模块。在上一篇教程中，我们所录制的宏，就是存在这个文件夹下的Module1中。

 - 在这个窗口中，还可能出现其它的对象，现在暂且不做讨论，当后面讲解到相应的内容的时候，大家自会明白。

### 属性窗口

属性窗口为截图中编号为3的区域，如果找不到此窗口，可以通过快捷键F4打开。

在本教程的前半部分，我们基本不会用到属性窗口，所以大家只需要暂时先记住有这个东西，就可以了。

### 立即窗口

属性窗口为截图中编号为4的区域，如果找不到此窗口，可以通过快捷键Ctrl+G打开。

立即窗口的主要用途在于调试代码，所以我们也暂时用不到，只需要先知道有这个东西。

### 代码窗口

代码窗口为截图中编号为5的区域，如果找不到此窗口，可以通过双击**工程窗口**中，**Modules**文件夹下的**Module1**打开。

这里就是用来编写VBA代码的地方。

在截图中已经可以看到一些代码，这些代码就是我们在上一篇教程中通过录制自动生成的。

在我们对VBA语言的基本知识有所了解之前，暂时不对代码的内容做任何解释。